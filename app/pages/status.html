<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>التحقق من حالة الطلب | قرية متعلمة</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
      /* Global styles and variables, consistent across all pages */
      :root {
        --primary-blue: #1d4ed8;
        --dark-blue: #1e3a8a;
        --light-blue: #e0f2fe;
        --accent-orange: #f59e0b;
        --text-color: #333;
        --light-bg: #eef2ff;
        --white: #ffffff;
        --gray-text: #888;
        --border-color: #93c5fd;
      }

      body {
        font-family: 'Cairo', sans-serif;
        background: linear-gradient(to bottom, var(--light-bg), var(--white));
        color: var(--text-color);
        margin: 0;
        padding: 0;
        line-height: 1.6;
        display: flex;
        flex-direction: column;
        min-height: 100vh;
      }

      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
      }

      /* Header styles - Consistent across all pages */
      .header {
        background: var(--dark-blue);
        padding: 1rem 0; /* Adjusted padding to be symmetrical and slightly less */
        color: var(--white);
        text-align: center;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        position: relative; 
        z-index: 10; /* Ensure header is above main content if any overlap issues */
      }

      .header .container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
      }

      .logo {
        font-size: 2.2rem;
        margin: 0;
        color: var(--white);
        white-space: nowrap; 
      }

      /* Navigation for larger screens (default) */
      .nav {
          display: flex; /* Display links side by side */
          gap: 1.5rem; /* Space between links */
          /* Important: On desktop, make sure max-height and padding are reset */
          max-height: none; 
          padding: 0;
          position: static; /* Reset position for desktop */
          width: auto;
      }

      .nav-link {
        color: var(--white);
        text-decoration: none;
        font-size: 1.1rem;
        transition: color 0.3s ease;
        white-space: nowrap; /* Prevent links from wrapping */
      }

      .nav-link:hover, .nav-link.active {
        color: var(--accent-orange);
      }

      /* Hamburger Menu Icon - Hidden by default on desktop */
      .menu-toggle {
        display: none; /* Hidden on large screens */
        flex-direction: column;
        justify-content: space-around;
        width: 30px;
        height: 25px;
        cursor: pointer;
        z-index: 100; /* Ensure it's above other elements */
        padding: 5px;
      }

      .menu-toggle .bar {
        width: 100%;
        height: 3px;
        background-color: var(--white);
        border-radius: 5px;
        transition: all 0.3s ease-in-out;
      }

      /* Main content styles */
      .main.container {
        flex: 1;
        text-align: center;
        padding: 3rem 1rem;
        max-width: 800px;
        margin: 2rem auto;
        background: var(--white);
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
        /* Ensure it's below the header */
        position: relative; 
        z-index: 1; 
      }

      .hero-title {
        font-size: 2.5rem;
        color: var(--primary-blue);
        margin: 1.5rem 0 1rem;
        position: relative;
        padding-bottom: 10px;
      }

      .hero-title::after {
        content: '';
        position: absolute;
        left: 50%;
        transform: translateX(-50%);
        bottom: 0;
        width: 80px;
        height: 4px;
        background-color: var(--accent-orange);
        border-radius: 2px;
      }

      .hero-text {
        font-size: 1.1rem;
        color: var(--gray-text);
        margin-bottom: 2rem;
      }

      /* Form styles */
      .form-section form {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
      }

      .form-section input[type="text"] {
        padding: 0.8rem;
        width: 100%;
        max-width: 400px;
        border: 1px solid #ccc;
        border-radius: 8px;
        font-size: 1rem;
        transition: border-color 0.3s ease, box-shadow 0.3s ease;
        text-align: right; /* RTL input */
        box-sizing: border-box; /* Include padding in width */
      }

      .form-section input[type="text"]:focus {
        border-color: var(--primary-blue);
        box-shadow: 0 0 0 3px rgba(29, 78, 216, 0.12);
        outline: none;
      }

      .btn-primary {
        background-color: var(--primary-blue);
        color: var(--white);
        padding: 0.9rem 2.5rem;
        font-size: 1.2rem;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: background-color 0.3s ease, transform 0.2s ease;
        font-weight: 700;
        letter-spacing: 0.5px;
      }

      .btn-primary:hover {
        background-color: #2563eb;
        transform: translateY(-2px);
      }

      /* Old table kept for compatibility but hidden when using new card list */
      .status-table { display: none; }

      /* Modern key-value card list */
      .kv-list {
        max-width: 720px;
        margin: 2rem auto;
        display: flex;
        flex-direction: column;
        gap: 12px;
        padding: 0 1rem;
      }
      .kv-row {
        display: grid;
        grid-template-columns: 1fr 1.6fr;
        gap: 14px;
        align-items: center;
        background: var(--white);
        padding: 14px 16px;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(2,6,23,0.06);
        border: 1px solid rgba(15,23,42,0.04);
      }
      /* in RTL the key should be on the right */
      .kv-key {
        text-align: right;
        font-weight: 700;
        color: var(--primary-blue);
        font-size: 1rem;
      }
      .kv-value {
        text-align: left;
        direction: ltr; /* keep numeric values left-to-right for readability */
        font-size: 1rem;
        color: var(--text-color);
      }
      .kv-value strong { color: var(--dark-blue); font-weight: 700; }
      .kv-value ul { margin: 0; padding-left: 1.1rem; list-style: disc; color: var(--text-color); }

      /* Status badges */
      .status-badge {
        display: inline-flex;
        gap: 8px;
        align-items: center;
        padding: 6px 10px;
        border-radius: 999px;
        font-weight: 700;
        font-size: 0.95rem;
      }
      .status-accepted { background:#e7f9ef; color:#0b6a3a; border: 1px solid rgba(11,106,58,0.08); }
      .status-rejected { background:#fff0f0; color:#9b1e1e; border: 1px solid rgba(155,30,30,0.06); }
      .status-pending { background:#fff8e6; color:#b36b00; border: 1px solid rgba(179,107,0,0.06); }

      .kv-note {
        font-size: 0.95rem;
        color: var(--gray-text);
      }

      /* Footer Styles - Consistent across all pages */
      .footer {
        margin-top: auto;
        text-align: center;
        color: var(--gray-text);
        padding: 1.5rem;
        font-size: 0.95rem;
        background-color: #f0f0f0;
        border-top: 1px solid #e5e5e5;
      }

      /* Responsive adjustments */
      @media (max-width: 768px) {
        .header .container {
          flex-direction: row; /* Keep logo and toggle on one row */
          justify-content: space-between; /* Space out logo and toggle */
          align-items: center;
        }

        .nav {
        display: flex;
        flex-direction: column; /* Stack links vertically on mobile */
        position: absolute;
        top: 100%; /* Position right below the header */
        left: 0;
        width: 100%;
        background: var(--dark-blue);
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        padding: 0; /* Reset padding for initial closed state */
        border-top: 1px solid rgba(255, 255, 255, 0.06);
        max-height: 0; /* Initially hidden */
        overflow: hidden;
        transition: max-height 0.32s cubic-bezier(.2,.9,.27,1), padding 0.24s ease-out;
      }

      .nav.open {
        max-height: 60vh; /* enough height for many links on small screens */
        padding: 0.6rem 0; /* vertical padding when open */
        overflow-y: auto;
        -webkit-overflow-scrolling: touch;
      }

      .nav-link {
        text-align: center;
        padding: 0.6rem 0; /* Vertical padding for individual links */
        font-size: 1.15rem;
        width: 100%;
        margin-bottom: 0;
        border-bottom: 1px solid rgba(255,255,255,0.03);
      }

      .menu-toggle {
        display: flex; /* Show hamburger icon on mobile */
        background: rgba(255,255,255,0.04);
      }

      .main.container {
        margin: 1rem auto;
        padding: 1.5rem 0.8rem;
      }

      .kv-row { grid-template-columns: 1fr 1fr; }
      .kv-value { direction: rtl; text-align: right; } /* on small screens keep RTL values aligned */
      }

      @media (max-width: 480px) {
        .logo {
          font-size: 1.8rem;
        }
        .nav-link {
          font-size: 1rem; /* Slightly smaller on very small screens */
        }
        .kv-row { padding: 12px; gap: 8px; border-radius: 10px; }
        .kv-key { font-size: 0.95rem; }
        .kv-value { font-size: 0.95rem; direction: rtl; text-align: right; }
      }
    </style>
  </head>
<body>
    <header class="header">
        <div class="container">
            <h1 class="logo">قرية متعلمة</h1>
            <div class="menu-toggle" id="mobile-menu" aria-label="قائمة الموقع" role="button" tabindex="0">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </div>
            <nav class="nav" id="main-nav">
                <a href="../index.html" class="nav-link">الرئيسية</a>
                <a href="./register.html" class="nav-link">التسجيل</a>
                <a href="./exam-status.html" class="nav-link">الامتحان</a>
                <a href="./status.html" class="nav-link active">حالة الطلب</a>
                <a href="./villages.html" class="nav-link">القرى</a>
            </nav>
        </div>
    </header>

    <main class="container">
        <section class="form-section">
            <h2 class="hero-title">تحقق من حالة طلبك</h2>
            <p class="hero-text">أدخل رقم الطلب والرقم القومي لمعرفة حالتك في القبول.</p>

            <form id="status-form" style="margin-top: 2rem;">
                <input
                    type="text"
                    id="request-id"
                    placeholder="أدخل رقم الطلب (مثال: rRMgT7)"
                    required
                />
                <input
                    type="text"
                    id="national-id"
                    placeholder="أدخل الرقم القومي (مثال: 30901252201795)"
                    required
                />
                <button type="submit" class="btn-primary">تحقق</button>
            </form>

            <div id="status-result" style="margin-top: 2rem;"></div>
        </section>
    </main>

    <footer class="footer">
        <p>&copy; 2025 منصة قرية متعلمة. جميع الحقوق محفوظة.</p>
    </footer>

    <script>
        // Simulated data for demonstration
        const applications = [
            {
                requestId: "rRMgT7",
                nationalId: "30901252201795",
                status: "accepted",
                name: "محمد احمد ربيع عبدالوهاب",
                age: 16,
                village: "قرية دشاشة",
                // تواريخ ثابتة خاصة بمحمد
                examDates: [
                    "السبت، 4 مايو 2024", 
                    "الأحد، 5 مايو 2024", 
                    "الإثنين، 6 مايو 2024"
                ],
                message: "تم قبول الطلب. يرجى الاستعداد والتوجه للامتحان في المواعيد المحددة.",
            },
            {
                requestId: "R2wndw",
                nationalId: "30407242201148",
                status: "accepted",
                name: "داليا أحمد ربيع عبدالوهاب",
                age: 21,
                village: "قرية دشاشة",
                // تواريخ ثابتة خاصة بداليا
                examDates: [
                    "السبت، 11 مايو 2024", 
                    "الأحد، 12 مايو 2024", 
                    "الإثنين، 13 مايو 2024"
                ],
                message: "تم قبول الطلب. يرجى الاستعداد والتوجه للامتحان في المواعيد المحددة.",
            },
            {
                // تم تغيير الحالة هنا لتوضيح حالة الرفض وعدم ظهور التواريخ
                requestId: "VIBatA", 
                nationalId: "30106062200801",
                status: "pending", 
                name: "ايه احمد ربيع عبد الوهاب",
                age: 24,
                village: "قرية دشاشة",
                examDates: [],
                message: "تم قبول الطلب. يرجى الاستعداد والتوجه للامتحان في المواعيد المحددة.",
            },
            {
                // تم تغيير الحالة هنا لتوضيح حالة الرفض وعدم ظهور التواريخ
                requestId: "tFDSBX", 
                nationalId: "30807302200853",
                status: "pending", 
                name: "سعيد طه سعيد امبارك",
                age: 17,
                village: "قرية دشاشة",
                examDates: [],
                
            }
        ];

        // *** تم إلغاء دالة getNextExamDates() كما طلبت ***

        document.getElementById("status-form").addEventListener("submit", function (e) {
            e.preventDefault();
            const requestId = document.getElementById("request-id").value.trim();
            const nationalId = document.getElementById("national-id").value.trim();
            const resultBox = document.getElementById("status-result");

            // Clear previous results
            resultBox.innerHTML = '';

            const foundApplication = applications.find(
                (app) => app.requestId === requestId && app.nationalId === nationalId
            );

            if (foundApplication) {
                let costPerDay = 0;
                let participantType = "";

                // Determine participant type and cost per day based on age
                if (foundApplication.age < 18) {
                    participantType = "طفل";
                    costPerDay = 100; // 100 EGP for children
                } else {
                    participantType = "شاب";
                    costPerDay = 200; // 200 EGP for youth
                }

                const totalExamCost = 3 * costPerDay; // 3 days exam

                // Build modern key-value card list
                const statusClass = foundApplication.status === 'accepted' ? 'status-accepted' :
                                    (foundApplication.status === 'rejected' ? 'status-rejected' : 'status-pending');
                const statusText = foundApplication.status === 'accepted' ? 'مقبول ✅' :
                                   (foundApplication.status === 'rejected' ? 'مرفوض ❌' : 'قيد المراجعة ⏳');

                let kvHtml = `<div class="kv-list">`;

                function addRow(key, value) {
                    kvHtml += `
                        <div class="kv-row">
                            <div class="kv-key">${key}</div>
                            <div class="kv-value">${value}</div>
                        </div>
                    `;
                }

                addRow('رقم الطلب', `<strong>${foundApplication.requestId}</strong>`);
                addRow('الرقم القومي', `<strong>${foundApplication.nationalId}</strong>`);
                addRow('الاسم الكامل', `<strong style="direction: rtl; display:block;">${foundApplication.name}</strong>`);
                addRow('السن', `${foundApplication.age} سنة (${participantType})`);
                addRow('القرية', `${foundApplication.village}`);
                addRow('الحالة', `<span class="status-badge ${statusClass}">${statusText}</span>`);

                if (foundApplication.status === "accepted") {
                    // *** استخدام التواريخ الثابتة المخزنة مباشرة من بيانات التطبيق ***
                    const examDates = foundApplication.examDates; 
                    addRow('أيام الامتحان', `3 أيام`);
                    addRow('تكلفة اليوم', `${costPerDay} جنيه مصري (${participantType})`);
                    addRow('إجمالي تكلفة الامتحان', `<strong>${totalExamCost} جنيه مصري</strong>`);
                    addRow('تواريخ الامتحانات', `<ul>${examDates.map(d => `<li style="direction: rtl;">${d}</li>`).join('')}</ul>`);
                } else if (foundApplication.status === "rejected" && foundApplication.reason) {
                    addRow('سبب الرفض', `${foundApplication.reason}`);
                } else if (foundApplication.status === "pending" && foundApplication.message) {
                    addRow('ملاحظات', `${foundApplication.message}`);
                }

                kvHtml += `</div>`; // close kv-list
                resultBox.innerHTML = kvHtml;
            } else {
                resultBox.innerHTML = `
                    <p class="message-box error-message">❌ لم يتم العثور على طلب بهذا الرقم القومي ورقم الطلب المدخلين. يرجى التحقق من البيانات والمحاولة مرة أخرى.</p>
                `;
            }
        });

        // JavaScript for Mobile Menu Toggle
        const mobileMenu = document.getElementById('mobile-menu');
        const mainNav = document.getElementById('main-nav');

        if (mobileMenu && mainNav) {
            mobileMenu.addEventListener('click', () => {
                mobileMenu.classList.toggle('open');
                mainNav.classList.toggle('open');
            });
            mobileMenu.addEventListener('keydown', (e) => {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    mobileMenu.click();
                }
            });
        }
    </script>
</body>
</html>
